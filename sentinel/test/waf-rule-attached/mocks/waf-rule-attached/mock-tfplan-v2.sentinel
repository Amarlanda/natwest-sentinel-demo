terraform_version = "1.11.4"

planned_values = {
	"outputs": {
		"alb_arn": {
			"name":      "alb_arn",
			"sensitive": false,
			"value":     undefined,
		},
		"alb_name": {
			"name":      "alb_name",
			"sensitive": false,
			"value":     "my-alb",
		},
		"waf_arn": {
			"name":      "waf_arn",
			"sensitive": false,
			"value":     "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
		},
		"waf_id": {
			"name":      "waf_id",
			"sensitive": false,
			"value":     "8690cef0-7421-4b05-9663-c2e226d348f9",
		},
		"waf_name": {
			"name":      "waf_name",
			"sensitive": false,
			"value":     "my-waf-web-acl",
		},
	},
	"resources": {
		"aws_lb.main": {
			"address":        "aws_lb.main",
			"depends_on":     [],
			"deposed_key":    "",
			"index":          null,
			"mode":           "managed",
			"module_address": "",
			"name":           "main",
			"provider_name":  "registry.terraform.io/hashicorp/aws",
			"tainted":        false,
			"type":           "aws_lb",
			"values": {
				"access_logs":                      [],
				"customer_owned_ipv4_pool":         null,
				"desync_mitigation_mode":           "defensive",
				"drop_invalid_header_fields":       false,
				"enable_cross_zone_load_balancing": null,
				"enable_deletion_protection":       false,
				"enable_http2":                     true,
				"enable_waf_fail_open":             false,
				"idle_timeout":                     60,
				"internal":                         false,
				"load_balancer_type":               "application",
				"name":                             "my-alb",
				"name_prefix":                      null,
				"preserve_host_header":             false,
				"subnets": [
					"subnet-066c2d3d16fe257e7",
					"subnet-074e6f80a28902317",
					"subnet-0d6f9bc18688e55fd",
				],
				"tags": {
					"Name": "my-alb",
				},
				"tags_all": {
					"Name": "my-alb",
				},
				"timeouts": null,
			},
		},
		"aws_lb_listener.http": {
			"address":        "aws_lb_listener.http",
			"depends_on":     [],
			"deposed_key":    "",
			"index":          null,
			"mode":           "managed",
			"module_address": "",
			"name":           "http",
			"provider_name":  "registry.terraform.io/hashicorp/aws",
			"tainted":        false,
			"type":           "aws_lb_listener",
			"values": {
				"alpn_policy":     null,
				"certificate_arn": null,
				"default_action": [
					{
						"authenticate_cognito": [],
						"authenticate_oidc":    [],
						"fixed_response":       [],
						"forward":              [],
						"redirect":             [],
						"type":                 "forward",
					},
				],
				"port":     80,
				"protocol": "HTTP",
				"tags":     null,
				"timeouts": null,
			},
		},
		"aws_lb_target_group.main": {
			"address":        "aws_lb_target_group.main",
			"depends_on":     [],
			"deposed_key":    "",
			"index":          null,
			"mode":           "managed",
			"module_address": "",
			"name":           "main",
			"provider_name":  "registry.terraform.io/hashicorp/aws",
			"tainted":        false,
			"type":           "aws_lb_target_group",
			"values": {
				"connection_termination": false,
				"deregistration_delay":   "300",
				"health_check": [
					{
						"enabled":             true,
						"healthy_threshold":   2,
						"interval":            30,
						"matcher":             "200-299",
						"path":                "/",
						"port":                "traffic-port",
						"protocol":            "HTTP",
						"timeout":             5,
						"unhealthy_threshold": 2,
					},
				],
				"lambda_multi_value_headers_enabled": false,
				"name":              "my-target-group",
				"name_prefix":       null,
				"port":              80,
				"protocol":          "HTTP",
				"proxy_protocol_v2": false,
				"slow_start":        0,
				"tags":              null,
				"target_type":       "instance",
				"vpc_id":            "vpc-0635ff1b62125588b",
			},
		},
		"aws_security_group.alb": {
			"address":        "aws_security_group.alb",
			"depends_on":     [],
			"deposed_key":    "",
			"index":          null,
			"mode":           "managed",
			"module_address": "",
			"name":           "alb",
			"provider_name":  "registry.terraform.io/hashicorp/aws",
			"tainted":        false,
			"type":           "aws_security_group",
			"values": {
				"description": "Security group for ALB",
				"egress": [
					{
						"cidr_blocks": [
							"0.0.0.0/0",
						],
						"description":      "",
						"from_port":        0,
						"ipv6_cidr_blocks": [],
						"prefix_list_ids":  [],
						"protocol":         "-1",
						"security_groups":  [],
						"self":             false,
						"to_port":          0,
					},
				],
				"ingress": [
					{
						"cidr_blocks": [
							"0.0.0.0/0",
						],
						"description":      "",
						"from_port":        443,
						"ipv6_cidr_blocks": [],
						"prefix_list_ids":  [],
						"protocol":         "tcp",
						"security_groups":  [],
						"self":             false,
						"to_port":          443,
					},
					{
						"cidr_blocks": [
							"0.0.0.0/0",
						],
						"description":      "",
						"from_port":        80,
						"ipv6_cidr_blocks": [],
						"prefix_list_ids":  [],
						"protocol":         "tcp",
						"security_groups":  [],
						"self":             false,
						"to_port":          80,
					},
				],
				"name": "alb-sg",
				"revoke_rules_on_delete": false,
				"tags":     null,
				"timeouts": null,
			},
		},
		"aws_wafv2_web_acl.main": {
			"address":        "aws_wafv2_web_acl.main",
			"depends_on":     [],
			"deposed_key":    "",
			"index":          null,
			"mode":           "managed",
			"module_address": "",
			"name":           "main",
			"provider_name":  "registry.terraform.io/hashicorp/aws",
			"tainted":        false,
			"type":           "aws_wafv2_web_acl",
			"values": {
				"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
				"capacity":             902,
				"custom_response_body": [],
				"default_action": [
					{
						"allow": [
							{
								"custom_request_handling": [],
							},
						],
						"block": [],
					},
				],
				"description": "Web ACL for protection against common web threats",
				"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
				"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
				"name":        "my-waf-web-acl",
				"rule": [
					{
						"action": [
							{
								"allow": [],
								"block": [
									{
										"custom_response": [],
									},
								],
								"captcha": [],
								"count":   [],
							},
						],
						"name":            "RateLimitRule",
						"override_action": [],
						"priority":        3,
						"rule_label":      [],
						"statement": [
							{
								"and_statement":                [],
								"byte_match_statement":         [],
								"geo_match_statement":          [],
								"ip_set_reference_statement":   [],
								"label_match_statement":        [],
								"managed_rule_group_statement": [],
								"not_statement":                [],
								"or_statement":                 [],
								"rate_based_statement": [
									{
										"aggregate_key_type":   "IP",
										"forwarded_ip_config":  [],
										"limit":                1000,
										"scope_down_statement": [],
									},
								],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "RateLimitRuleMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
					{
						"action": [],
						"name":   "AWSManagedRulesCommonRuleSet",
						"override_action": [
							{
								"count": [],
								"none": [
									{},
								],
							},
						],
						"priority":   1,
						"rule_label": [],
						"statement": [
							{
								"and_statement":              [],
								"byte_match_statement":       [],
								"geo_match_statement":        [],
								"ip_set_reference_statement": [],
								"label_match_statement":      [],
								"managed_rule_group_statement": [
									{
										"excluded_rule":        [],
										"name":                 "AWSManagedRulesCommonRuleSet",
										"scope_down_statement": [],
										"vendor_name":          "AWS",
										"version":              "",
									},
								],
								"not_statement":                         [],
								"or_statement":                          [],
								"rate_based_statement":                  [],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
					{
						"action": [],
						"name":   "AWSManagedRulesSQLiRuleSet",
						"override_action": [
							{
								"count": [],
								"none": [
									{},
								],
							},
						],
						"priority":   2,
						"rule_label": [],
						"statement": [
							{
								"and_statement":              [],
								"byte_match_statement":       [],
								"geo_match_statement":        [],
								"ip_set_reference_statement": [],
								"label_match_statement":      [],
								"managed_rule_group_statement": [
									{
										"excluded_rule":        [],
										"name":                 "AWSManagedRulesSQLiRuleSet",
										"scope_down_statement": [],
										"vendor_name":          "AWS",
										"version":              "",
									},
								],
								"not_statement":                         [],
								"or_statement":                          [],
								"rate_based_statement":                  [],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
				],
				"scope": "REGIONAL",
				"tags": {
					"Name": "my-waf-web-acl",
				},
				"tags_all": {
					"Name": "my-waf-web-acl",
				},
				"visibility_config": [
					{
						"cloudwatch_metrics_enabled": true,
						"metric_name":                "WebACLMetric",
						"sampled_requests_enabled":   true,
					},
				],
			},
		},
		"aws_wafv2_web_acl_association.main": {
			"address":        "aws_wafv2_web_acl_association.main",
			"depends_on":     [],
			"deposed_key":    "",
			"index":          null,
			"mode":           "managed",
			"module_address": "",
			"name":           "main",
			"provider_name":  "registry.terraform.io/hashicorp/aws",
			"tainted":        false,
			"type":           "aws_wafv2_web_acl_association",
			"values": {
				"web_acl_arn": "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
			},
		},
	},
}

variables = {
	"waf_name": {
		"name":  "waf_name",
		"value": "my-waf-web-acl",
	},
}

resource_changes = {
	"aws_lb.main": {
		"address": "aws_lb.main",
		"change": {
			"actions": [
				"create",
			],
			"after": {
				"access_logs":                      [],
				"customer_owned_ipv4_pool":         null,
				"desync_mitigation_mode":           "defensive",
				"drop_invalid_header_fields":       false,
				"enable_cross_zone_load_balancing": null,
				"enable_deletion_protection":       false,
				"enable_http2":                     true,
				"enable_waf_fail_open":             false,
				"idle_timeout":                     60,
				"internal":                         false,
				"load_balancer_type":               "application",
				"name":                             "my-alb",
				"name_prefix":                      null,
				"preserve_host_header":             false,
				"subnets": [
					"subnet-066c2d3d16fe257e7",
					"subnet-074e6f80a28902317",
					"subnet-0d6f9bc18688e55fd",
				],
				"tags": {
					"Name": "my-alb",
				},
				"tags_all": {
					"Name": "my-alb",
				},
				"timeouts": null,
			},
			"after_unknown": {
				"access_logs":     [],
				"arn":             true,
				"arn_suffix":      true,
				"dns_name":        true,
				"id":              true,
				"ip_address_type": true,
				"security_groups": true,
				"subnet_mapping":  true,
				"subnets": [
					false,
					false,
					false,
				],
				"tags":     {},
				"tags_all": {},
				"vpc_id":   true,
				"zone_id":  true,
			},
			"before": null,
		},
		"deposed":        "",
		"index":          null,
		"mode":           "managed",
		"module_address": "",
		"name":           "main",
		"provider_name":  "registry.terraform.io/hashicorp/aws",
		"type":           "aws_lb",
	},
	"aws_lb_listener.http": {
		"address": "aws_lb_listener.http",
		"change": {
			"actions": [
				"create",
			],
			"after": {
				"alpn_policy":     null,
				"certificate_arn": null,
				"default_action": [
					{
						"authenticate_cognito": [],
						"authenticate_oidc":    [],
						"fixed_response":       [],
						"forward":              [],
						"redirect":             [],
						"type":                 "forward",
					},
				],
				"port":     80,
				"protocol": "HTTP",
				"tags":     null,
				"timeouts": null,
			},
			"after_unknown": {
				"arn": true,
				"default_action": [
					{
						"authenticate_cognito": [],
						"authenticate_oidc":    [],
						"fixed_response":       [],
						"forward":              [],
						"order":                true,
						"redirect":             [],
						"target_group_arn":     true,
					},
				],
				"id":                true,
				"load_balancer_arn": true,
				"ssl_policy":        true,
				"tags_all":          true,
			},
			"before": null,
		},
		"deposed":        "",
		"index":          null,
		"mode":           "managed",
		"module_address": "",
		"name":           "http",
		"provider_name":  "registry.terraform.io/hashicorp/aws",
		"type":           "aws_lb_listener",
	},
	"aws_lb_target_group.main": {
		"address": "aws_lb_target_group.main",
		"change": {
			"actions": [
				"create",
			],
			"after": {
				"connection_termination": false,
				"deregistration_delay":   "300",
				"health_check": [
					{
						"enabled":             true,
						"healthy_threshold":   2,
						"interval":            30,
						"matcher":             "200-299",
						"path":                "/",
						"port":                "traffic-port",
						"protocol":            "HTTP",
						"timeout":             5,
						"unhealthy_threshold": 2,
					},
				],
				"lambda_multi_value_headers_enabled": false,
				"name":              "my-target-group",
				"name_prefix":       null,
				"port":              80,
				"protocol":          "HTTP",
				"proxy_protocol_v2": false,
				"slow_start":        0,
				"tags":              null,
				"target_type":       "instance",
				"vpc_id":            "vpc-0635ff1b62125588b",
			},
			"after_unknown": {
				"arn":        true,
				"arn_suffix": true,
				"health_check": [
					{},
				],
				"id":                            true,
				"ip_address_type":               true,
				"load_balancing_algorithm_type": true,
				"preserve_client_ip":            true,
				"protocol_version":              true,
				"stickiness":                    true,
				"tags_all":                      true,
			},
			"before": null,
		},
		"deposed":        "",
		"index":          null,
		"mode":           "managed",
		"module_address": "",
		"name":           "main",
		"provider_name":  "registry.terraform.io/hashicorp/aws",
		"type":           "aws_lb_target_group",
	},
	"aws_security_group.alb": {
		"address": "aws_security_group.alb",
		"change": {
			"actions": [
				"create",
			],
			"after": {
				"description": "Security group for ALB",
				"egress": [
					{
						"cidr_blocks": [
							"0.0.0.0/0",
						],
						"description":      "",
						"from_port":        0,
						"ipv6_cidr_blocks": [],
						"prefix_list_ids":  [],
						"protocol":         "-1",
						"security_groups":  [],
						"self":             false,
						"to_port":          0,
					},
				],
				"ingress": [
					{
						"cidr_blocks": [
							"0.0.0.0/0",
						],
						"description":      "",
						"from_port":        443,
						"ipv6_cidr_blocks": [],
						"prefix_list_ids":  [],
						"protocol":         "tcp",
						"security_groups":  [],
						"self":             false,
						"to_port":          443,
					},
					{
						"cidr_blocks": [
							"0.0.0.0/0",
						],
						"description":      "",
						"from_port":        80,
						"ipv6_cidr_blocks": [],
						"prefix_list_ids":  [],
						"protocol":         "tcp",
						"security_groups":  [],
						"self":             false,
						"to_port":          80,
					},
				],
				"name": "alb-sg",
				"revoke_rules_on_delete": false,
				"tags":     null,
				"timeouts": null,
			},
			"after_unknown": {
				"arn": true,
				"egress": [
					{
						"cidr_blocks": [
							false,
						],
						"ipv6_cidr_blocks": [],
						"prefix_list_ids":  [],
						"security_groups":  [],
					},
				],
				"id": true,
				"ingress": [
					{
						"cidr_blocks": [
							false,
						],
						"ipv6_cidr_blocks": [],
						"prefix_list_ids":  [],
						"security_groups":  [],
					},
					{
						"cidr_blocks": [
							false,
						],
						"ipv6_cidr_blocks": [],
						"prefix_list_ids":  [],
						"security_groups":  [],
					},
				],
				"name_prefix": true,
				"owner_id":    true,
				"tags_all":    true,
				"vpc_id":      true,
			},
			"before": null,
		},
		"deposed":        "",
		"index":          null,
		"mode":           "managed",
		"module_address": "",
		"name":           "alb",
		"provider_name":  "registry.terraform.io/hashicorp/aws",
		"type":           "aws_security_group",
	},
	"aws_wafv2_web_acl.main": {
		"address": "aws_wafv2_web_acl.main",
		"change": {
			"actions": [
				"no-op",
			],
			"after": {
				"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
				"capacity":             902,
				"custom_response_body": [],
				"default_action": [
					{
						"allow": [
							{
								"custom_request_handling": [],
							},
						],
						"block": [],
					},
				],
				"description": "Web ACL for protection against common web threats",
				"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
				"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
				"name":        "my-waf-web-acl",
				"rule": [
					{
						"action": [
							{
								"allow": [],
								"block": [
									{
										"custom_response": [],
									},
								],
								"captcha": [],
								"count":   [],
							},
						],
						"name":            "RateLimitRule",
						"override_action": [],
						"priority":        3,
						"rule_label":      [],
						"statement": [
							{
								"and_statement":                [],
								"byte_match_statement":         [],
								"geo_match_statement":          [],
								"ip_set_reference_statement":   [],
								"label_match_statement":        [],
								"managed_rule_group_statement": [],
								"not_statement":                [],
								"or_statement":                 [],
								"rate_based_statement": [
									{
										"aggregate_key_type":   "IP",
										"forwarded_ip_config":  [],
										"limit":                1000,
										"scope_down_statement": [],
									},
								],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "RateLimitRuleMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
					{
						"action": [],
						"name":   "AWSManagedRulesCommonRuleSet",
						"override_action": [
							{
								"count": [],
								"none": [
									{},
								],
							},
						],
						"priority":   1,
						"rule_label": [],
						"statement": [
							{
								"and_statement":              [],
								"byte_match_statement":       [],
								"geo_match_statement":        [],
								"ip_set_reference_statement": [],
								"label_match_statement":      [],
								"managed_rule_group_statement": [
									{
										"excluded_rule":        [],
										"name":                 "AWSManagedRulesCommonRuleSet",
										"scope_down_statement": [],
										"vendor_name":          "AWS",
										"version":              "",
									},
								],
								"not_statement":                         [],
								"or_statement":                          [],
								"rate_based_statement":                  [],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
					{
						"action": [],
						"name":   "AWSManagedRulesSQLiRuleSet",
						"override_action": [
							{
								"count": [],
								"none": [
									{},
								],
							},
						],
						"priority":   2,
						"rule_label": [],
						"statement": [
							{
								"and_statement":              [],
								"byte_match_statement":       [],
								"geo_match_statement":        [],
								"ip_set_reference_statement": [],
								"label_match_statement":      [],
								"managed_rule_group_statement": [
									{
										"excluded_rule":        [],
										"name":                 "AWSManagedRulesSQLiRuleSet",
										"scope_down_statement": [],
										"vendor_name":          "AWS",
										"version":              "",
									},
								],
								"not_statement":                         [],
								"or_statement":                          [],
								"rate_based_statement":                  [],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
				],
				"scope": "REGIONAL",
				"tags": {
					"Name": "my-waf-web-acl",
				},
				"tags_all": {
					"Name": "my-waf-web-acl",
				},
				"visibility_config": [
					{
						"cloudwatch_metrics_enabled": true,
						"metric_name":                "WebACLMetric",
						"sampled_requests_enabled":   true,
					},
				],
			},
			"after_unknown": {},
			"before": {
				"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
				"capacity":             902,
				"custom_response_body": [],
				"default_action": [
					{
						"allow": [
							{
								"custom_request_handling": [],
							},
						],
						"block": [],
					},
				],
				"description": "Web ACL for protection against common web threats",
				"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
				"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
				"name":        "my-waf-web-acl",
				"rule": [
					{
						"action": [
							{
								"allow": [],
								"block": [
									{
										"custom_response": [],
									},
								],
								"captcha": [],
								"count":   [],
							},
						],
						"name":            "RateLimitRule",
						"override_action": [],
						"priority":        3,
						"rule_label":      [],
						"statement": [
							{
								"and_statement":                [],
								"byte_match_statement":         [],
								"geo_match_statement":          [],
								"ip_set_reference_statement":   [],
								"label_match_statement":        [],
								"managed_rule_group_statement": [],
								"not_statement":                [],
								"or_statement":                 [],
								"rate_based_statement": [
									{
										"aggregate_key_type":   "IP",
										"forwarded_ip_config":  [],
										"limit":                1000,
										"scope_down_statement": [],
									},
								],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "RateLimitRuleMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
					{
						"action": [],
						"name":   "AWSManagedRulesCommonRuleSet",
						"override_action": [
							{
								"count": [],
								"none": [
									{},
								],
							},
						],
						"priority":   1,
						"rule_label": [],
						"statement": [
							{
								"and_statement":              [],
								"byte_match_statement":       [],
								"geo_match_statement":        [],
								"ip_set_reference_statement": [],
								"label_match_statement":      [],
								"managed_rule_group_statement": [
									{
										"excluded_rule":        [],
										"name":                 "AWSManagedRulesCommonRuleSet",
										"scope_down_statement": [],
										"vendor_name":          "AWS",
										"version":              "",
									},
								],
								"not_statement":                         [],
								"or_statement":                          [],
								"rate_based_statement":                  [],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
					{
						"action": [],
						"name":   "AWSManagedRulesSQLiRuleSet",
						"override_action": [
							{
								"count": [],
								"none": [
									{},
								],
							},
						],
						"priority":   2,
						"rule_label": [],
						"statement": [
							{
								"and_statement":              [],
								"byte_match_statement":       [],
								"geo_match_statement":        [],
								"ip_set_reference_statement": [],
								"label_match_statement":      [],
								"managed_rule_group_statement": [
									{
										"excluded_rule":        [],
										"name":                 "AWSManagedRulesSQLiRuleSet",
										"scope_down_statement": [],
										"vendor_name":          "AWS",
										"version":              "",
									},
								],
								"not_statement":                         [],
								"or_statement":                          [],
								"rate_based_statement":                  [],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
				],
				"scope": "REGIONAL",
				"tags": {
					"Name": "my-waf-web-acl",
				},
				"tags_all": {
					"Name": "my-waf-web-acl",
				},
				"visibility_config": [
					{
						"cloudwatch_metrics_enabled": true,
						"metric_name":                "WebACLMetric",
						"sampled_requests_enabled":   true,
					},
				],
			},
		},
		"deposed":        "",
		"index":          null,
		"mode":           "managed",
		"module_address": "",
		"name":           "main",
		"provider_name":  "registry.terraform.io/hashicorp/aws",
		"type":           "aws_wafv2_web_acl",
	},
	"aws_wafv2_web_acl_association.main": {
		"address": "aws_wafv2_web_acl_association.main",
		"change": {
			"actions": [
				"create",
			],
			"after": {
				"web_acl_arn": "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
			},
			"after_unknown": {
				"id":           true,
				"resource_arn": true,
			},
			"before": null,
		},
		"deposed":        "",
		"index":          null,
		"mode":           "managed",
		"module_address": "",
		"name":           "main",
		"provider_name":  "registry.terraform.io/hashicorp/aws",
		"type":           "aws_wafv2_web_acl_association",
	},
}

resource_drift = {
	"aws_wafv2_web_acl.main": {
		"address": "aws_wafv2_web_acl.main",
		"change": {
			"actions": [
				"update",
			],
			"after": {
				"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
				"capacity":             902,
				"custom_response_body": [],
				"default_action": [
					{
						"allow": [
							{
								"custom_request_handling": [],
							},
						],
						"block": [],
					},
				],
				"description": "Web ACL for protection against common web threats",
				"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
				"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
				"name":        "my-waf-web-acl",
				"rule": [
					{
						"action": [
							{
								"allow": [],
								"block": [
									{
										"custom_response": [],
									},
								],
								"captcha": [],
								"count":   [],
							},
						],
						"name":            "RateLimitRule",
						"override_action": [],
						"priority":        3,
						"rule_label":      [],
						"statement": [
							{
								"and_statement":                [],
								"byte_match_statement":         [],
								"geo_match_statement":          [],
								"ip_set_reference_statement":   [],
								"label_match_statement":        [],
								"managed_rule_group_statement": [],
								"not_statement":                [],
								"or_statement":                 [],
								"rate_based_statement": [
									{
										"aggregate_key_type":   "IP",
										"forwarded_ip_config":  [],
										"limit":                1000,
										"scope_down_statement": [],
									},
								],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "RateLimitRuleMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
					{
						"action": [],
						"name":   "AWSManagedRulesCommonRuleSet",
						"override_action": [
							{
								"count": [],
								"none": [
									{},
								],
							},
						],
						"priority":   1,
						"rule_label": [],
						"statement": [
							{
								"and_statement":              [],
								"byte_match_statement":       [],
								"geo_match_statement":        [],
								"ip_set_reference_statement": [],
								"label_match_statement":      [],
								"managed_rule_group_statement": [
									{
										"excluded_rule":        [],
										"name":                 "AWSManagedRulesCommonRuleSet",
										"scope_down_statement": [],
										"vendor_name":          "AWS",
										"version":              "",
									},
								],
								"not_statement":                         [],
								"or_statement":                          [],
								"rate_based_statement":                  [],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
					{
						"action": [],
						"name":   "AWSManagedRulesSQLiRuleSet",
						"override_action": [
							{
								"count": [],
								"none": [
									{},
								],
							},
						],
						"priority":   2,
						"rule_label": [],
						"statement": [
							{
								"and_statement":              [],
								"byte_match_statement":       [],
								"geo_match_statement":        [],
								"ip_set_reference_statement": [],
								"label_match_statement":      [],
								"managed_rule_group_statement": [
									{
										"excluded_rule":        [],
										"name":                 "AWSManagedRulesSQLiRuleSet",
										"scope_down_statement": [],
										"vendor_name":          "AWS",
										"version":              "",
									},
								],
								"not_statement":                         [],
								"or_statement":                          [],
								"rate_based_statement":                  [],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
				],
				"scope": "REGIONAL",
				"tags": {
					"Name": "my-waf-web-acl",
				},
				"tags_all": {
					"Name": "my-waf-web-acl",
				},
				"visibility_config": [
					{
						"cloudwatch_metrics_enabled": true,
						"metric_name":                "WebACLMetric",
						"sampled_requests_enabled":   true,
					},
				],
			},
			"after_unknown": {},
			"before": {
				"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
				"capacity":             902,
				"custom_response_body": [],
				"default_action": [
					{
						"allow": [
							{
								"custom_request_handling": [],
							},
						],
						"block": [],
					},
				],
				"description": "Web ACL for protection against common web threats",
				"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
				"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
				"name":        "my-waf-web-acl",
				"rule": [
					{
						"action": [
							{
								"allow": [],
								"block": [
									{
										"custom_response": [],
									},
								],
								"captcha": [],
								"count":   [],
							},
						],
						"name":            "RateLimitRule",
						"override_action": [],
						"priority":        3,
						"rule_label":      [],
						"statement": [
							{
								"and_statement":                [],
								"byte_match_statement":         [],
								"geo_match_statement":          [],
								"ip_set_reference_statement":   [],
								"label_match_statement":        [],
								"managed_rule_group_statement": [],
								"not_statement":                [],
								"or_statement":                 [],
								"rate_based_statement": [
									{
										"aggregate_key_type":   "IP",
										"forwarded_ip_config":  [],
										"limit":                1000,
										"scope_down_statement": [],
									},
								],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "RateLimitRuleMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
					{
						"action": [],
						"name":   "AWSManagedRulesCommonRuleSet",
						"override_action": [
							{
								"count": [],
								"none": [
									{},
								],
							},
						],
						"priority":   1,
						"rule_label": [],
						"statement": [
							{
								"and_statement":              [],
								"byte_match_statement":       [],
								"geo_match_statement":        [],
								"ip_set_reference_statement": [],
								"label_match_statement":      [],
								"managed_rule_group_statement": [
									{
										"excluded_rule":        [],
										"name":                 "AWSManagedRulesCommonRuleSet",
										"scope_down_statement": [],
										"vendor_name":          "AWS",
										"version":              null,
									},
								],
								"not_statement":                         [],
								"or_statement":                          [],
								"rate_based_statement":                  [],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
					{
						"action": [],
						"name":   "AWSManagedRulesSQLiRuleSet",
						"override_action": [
							{
								"count": [],
								"none": [
									{},
								],
							},
						],
						"priority":   2,
						"rule_label": [],
						"statement": [
							{
								"and_statement":              [],
								"byte_match_statement":       [],
								"geo_match_statement":        [],
								"ip_set_reference_statement": [],
								"label_match_statement":      [],
								"managed_rule_group_statement": [
									{
										"excluded_rule":        [],
										"name":                 "AWSManagedRulesSQLiRuleSet",
										"scope_down_statement": [],
										"vendor_name":          "AWS",
										"version":              null,
									},
								],
								"not_statement":                         [],
								"or_statement":                          [],
								"rate_based_statement":                  [],
								"regex_pattern_set_reference_statement": [],
								"rule_group_reference_statement":        [],
								"size_constraint_statement":             [],
								"sqli_match_statement":                  [],
								"xss_match_statement":                   [],
							},
						],
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
				],
				"scope": "REGIONAL",
				"tags": {
					"Name": "my-waf-web-acl",
				},
				"tags_all": null,
				"visibility_config": [
					{
						"cloudwatch_metrics_enabled": true,
						"metric_name":                "WebACLMetric",
						"sampled_requests_enabled":   true,
					},
				],
			},
		},
		"deposed":        "",
		"index":          null,
		"mode":           "managed",
		"module_address": "",
		"name":           "main",
		"provider_name":  "registry.terraform.io/hashicorp/aws",
		"type":           "aws_wafv2_web_acl",
	},
}

output_changes = {
	"alb_arn": {
		"change": {
			"actions": [
				"create",
			],
			"after":         undefined,
			"after_unknown": true,
			"before":        null,
		},
		"name": "alb_arn",
	},
	"alb_name": {
		"change": {
			"actions": [
				"create",
			],
			"after":         "my-alb",
			"after_unknown": false,
			"before":        null,
		},
		"name": "alb_name",
	},
	"waf_arn": {
		"change": {
			"actions": [
				"no-op",
			],
			"after":         "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
			"after_unknown": false,
			"before":        "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
		},
		"name": "waf_arn",
	},
	"waf_id": {
		"change": {
			"actions": [
				"no-op",
			],
			"after":         "8690cef0-7421-4b05-9663-c2e226d348f9",
			"after_unknown": false,
			"before":        "8690cef0-7421-4b05-9663-c2e226d348f9",
		},
		"name": "waf_id",
	},
	"waf_name": {
		"change": {
			"actions": [
				"no-op",
			],
			"after":         "my-waf-web-acl",
			"after_unknown": false,
			"before":        "my-waf-web-acl",
		},
		"name": "waf_name",
	},
}

raw = {
	"configuration": {
		"provider_config": {
			"aws": {
				"full_name":          "registry.terraform.io/hashicorp/aws",
				"name":               "aws",
				"version_constraint": "~> 4.28.0",
			},
		},
		"root_module": {
			"outputs": {
				"alb_arn": {
					"expression": {
						"references": [
							"aws_lb.main.arn",
							"aws_lb.main",
						],
					},
				},
				"alb_name": {
					"expression": {
						"references": [
							"aws_lb.main.name",
							"aws_lb.main",
						],
					},
				},
				"waf_arn": {
					"expression": {
						"references": [
							"aws_wafv2_web_acl.main.arn",
							"aws_wafv2_web_acl.main",
						],
					},
				},
				"waf_id": {
					"expression": {
						"references": [
							"aws_wafv2_web_acl.main.id",
							"aws_wafv2_web_acl.main",
						],
					},
				},
				"waf_name": {
					"expression": {
						"references": [
							"var.waf_name",
						],
					},
				},
			},
			"resources": [
				{
					"address": "aws_lb.main",
					"expressions": {
						"internal": {
							"constant_value": false,
						},
						"load_balancer_type": {
							"constant_value": "application",
						},
						"name": {
							"constant_value": "my-alb",
						},
						"security_groups": {
							"references": [
								"aws_security_group.alb.id",
								"aws_security_group.alb",
							],
						},
						"subnets": {
							"references": [
								"data.aws_subnets.default.ids",
								"data.aws_subnets.default",
							],
						},
						"tags": {
							"constant_value": {
								"Name": "my-alb",
							},
						},
					},
					"mode":                "managed",
					"name":                "main",
					"provider_config_key": "aws",
					"schema_version":      0,
					"type":                "aws_lb",
				},
				{
					"address": "aws_lb_listener.http",
					"expressions": {
						"default_action": [
							{
								"target_group_arn": {
									"references": [
										"aws_lb_target_group.main.arn",
										"aws_lb_target_group.main",
									],
								},
								"type": {
									"constant_value": "forward",
								},
							},
						],
						"load_balancer_arn": {
							"references": [
								"aws_lb.main.arn",
								"aws_lb.main",
							],
						},
						"port": {
							"constant_value": "80",
						},
						"protocol": {
							"constant_value": "HTTP",
						},
					},
					"mode":                "managed",
					"name":                "http",
					"provider_config_key": "aws",
					"schema_version":      0,
					"type":                "aws_lb_listener",
				},
				{
					"address": "aws_lb_target_group.main",
					"expressions": {
						"health_check": [
							{
								"healthy_threshold": {
									"constant_value": 2,
								},
								"interval": {
									"constant_value": 30,
								},
								"matcher": {
									"constant_value": "200-299",
								},
								"path": {
									"constant_value": "/",
								},
								"protocol": {
									"constant_value": "HTTP",
								},
								"timeout": {
									"constant_value": 5,
								},
								"unhealthy_threshold": {
									"constant_value": 2,
								},
							},
						],
						"name": {
							"constant_value": "my-target-group",
						},
						"port": {
							"constant_value": 80,
						},
						"protocol": {
							"constant_value": "HTTP",
						},
						"vpc_id": {
							"references": [
								"data.aws_vpc.default.id",
								"data.aws_vpc.default",
							],
						},
					},
					"mode":                "managed",
					"name":                "main",
					"provider_config_key": "aws",
					"schema_version":      0,
					"type":                "aws_lb_target_group",
				},
				{
					"address": "aws_security_group.alb",
					"expressions": {
						"description": {
							"constant_value": "Security group for ALB",
						},
						"egress": {
							"constant_value": [
								{
									"cidr_blocks": [
										"0.0.0.0/0",
									],
									"description":      null,
									"from_port":        0,
									"ipv6_cidr_blocks": null,
									"prefix_list_ids":  null,
									"protocol":         "-1",
									"security_groups":  null,
									"self":             null,
									"to_port":          0,
								},
							],
						},
						"ingress": {
							"constant_value": [
								{
									"cidr_blocks": [
										"0.0.0.0/0",
									],
									"description":      null,
									"from_port":        80,
									"ipv6_cidr_blocks": null,
									"prefix_list_ids":  null,
									"protocol":         "tcp",
									"security_groups":  null,
									"self":             null,
									"to_port":          80,
								},
								{
									"cidr_blocks": [
										"0.0.0.0/0",
									],
									"description":      null,
									"from_port":        443,
									"ipv6_cidr_blocks": null,
									"prefix_list_ids":  null,
									"protocol":         "tcp",
									"security_groups":  null,
									"self":             null,
									"to_port":          443,
								},
							],
						},
						"name": {
							"constant_value": "alb-sg",
						},
					},
					"mode":                "managed",
					"name":                "alb",
					"provider_config_key": "aws",
					"schema_version":      1,
					"type":                "aws_security_group",
				},
				{
					"address": "aws_wafv2_web_acl.main",
					"expressions": {
						"default_action": [
							{
								"allow": [
									{},
								],
							},
						],
						"description": {
							"constant_value": "Web ACL for protection against common web threats",
						},
						"name": {
							"references": [
								"var.waf_name",
							],
						},
						"rule": [
							{
								"name": {
									"constant_value": "AWSManagedRulesCommonRuleSet",
								},
								"override_action": [
									{
										"none": [
											{},
										],
									},
								],
								"priority": {
									"constant_value": 1,
								},
								"statement": [
									{
										"managed_rule_group_statement": [
											{
												"name": {
													"constant_value": "AWSManagedRulesCommonRuleSet",
												},
												"vendor_name": {
													"constant_value": "AWS",
												},
											},
										],
									},
								],
								"visibility_config": [
									{
										"cloudwatch_metrics_enabled": {
											"constant_value": true,
										},
										"metric_name": {
											"constant_value": "AWSManagedRulesCommonRuleSetMetric",
										},
										"sampled_requests_enabled": {
											"constant_value": true,
										},
									},
								],
							},
							{
								"name": {
									"constant_value": "AWSManagedRulesSQLiRuleSet",
								},
								"override_action": [
									{
										"none": [
											{},
										],
									},
								],
								"priority": {
									"constant_value": 2,
								},
								"statement": [
									{
										"managed_rule_group_statement": [
											{
												"name": {
													"constant_value": "AWSManagedRulesSQLiRuleSet",
												},
												"vendor_name": {
													"constant_value": "AWS",
												},
											},
										],
									},
								],
								"visibility_config": [
									{
										"cloudwatch_metrics_enabled": {
											"constant_value": true,
										},
										"metric_name": {
											"constant_value": "AWSManagedRulesSQLiRuleSetMetric",
										},
										"sampled_requests_enabled": {
											"constant_value": true,
										},
									},
								],
							},
							{
								"action": [
									{
										"block": [
											{},
										],
									},
								],
								"name": {
									"constant_value": "RateLimitRule",
								},
								"priority": {
									"constant_value": 3,
								},
								"statement": [
									{
										"rate_based_statement": [
											{
												"aggregate_key_type": {
													"constant_value": "IP",
												},
												"limit": {
													"constant_value": 1000,
												},
											},
										],
									},
								],
								"visibility_config": [
									{
										"cloudwatch_metrics_enabled": {
											"constant_value": true,
										},
										"metric_name": {
											"constant_value": "RateLimitRuleMetric",
										},
										"sampled_requests_enabled": {
											"constant_value": true,
										},
									},
								],
							},
						],
						"scope": {
							"constant_value": "REGIONAL",
						},
						"tags": {
							"references": [
								"var.waf_name",
							],
						},
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": {
									"constant_value": true,
								},
								"metric_name": {
									"constant_value": "WebACLMetric",
								},
								"sampled_requests_enabled": {
									"constant_value": true,
								},
							},
						],
					},
					"mode":                "managed",
					"name":                "main",
					"provider_config_key": "aws",
					"schema_version":      0,
					"type":                "aws_wafv2_web_acl",
				},
				{
					"address": "aws_wafv2_web_acl_association.main",
					"expressions": {
						"resource_arn": {
							"references": [
								"aws_lb.main.arn",
								"aws_lb.main",
							],
						},
						"web_acl_arn": {
							"references": [
								"aws_wafv2_web_acl.main.arn",
								"aws_wafv2_web_acl.main",
							],
						},
					},
					"mode":                "managed",
					"name":                "main",
					"provider_config_key": "aws",
					"schema_version":      0,
					"type":                "aws_wafv2_web_acl_association",
				},
				{
					"address": "data.aws_subnets.default",
					"expressions": {
						"filter": [
							{
								"name": {
									"constant_value": "vpc-id",
								},
								"values": {
									"references": [
										"data.aws_vpc.default.id",
										"data.aws_vpc.default",
									],
								},
							},
							{
								"name": {
									"constant_value": "default-for-az",
								},
								"values": {
									"constant_value": [
										"true",
									],
								},
							},
						],
					},
					"mode":                "data",
					"name":                "default",
					"provider_config_key": "aws",
					"schema_version":      0,
					"type":                "aws_subnets",
				},
				{
					"address": "data.aws_vpc.default",
					"expressions": {
						"default": {
							"constant_value": true,
						},
					},
					"mode":                "data",
					"name":                "default",
					"provider_config_key": "aws",
					"schema_version":      0,
					"type":                "aws_vpc",
				},
			],
			"variables": {
				"waf_name": {
					"default":     "my-waf-web-acl",
					"description": "Name for the WAF Web ACL",
				},
			},
		},
	},
	"format_version": "1.2",
	"output_changes": {
		"alb_arn": {
			"actions": [
				"create",
			],
			"after_sensitive":  false,
			"after_unknown":    true,
			"before":           null,
			"before_sensitive": false,
		},
		"alb_name": {
			"actions": [
				"create",
			],
			"after":            "my-alb",
			"after_sensitive":  false,
			"after_unknown":    false,
			"before":           null,
			"before_sensitive": false,
		},
		"waf_arn": {
			"actions": [
				"no-op",
			],
			"after":            "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
			"after_sensitive":  false,
			"after_unknown":    false,
			"before":           "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
			"before_sensitive": false,
		},
		"waf_id": {
			"actions": [
				"no-op",
			],
			"after":            "8690cef0-7421-4b05-9663-c2e226d348f9",
			"after_sensitive":  false,
			"after_unknown":    false,
			"before":           "8690cef0-7421-4b05-9663-c2e226d348f9",
			"before_sensitive": false,
		},
		"waf_name": {
			"actions": [
				"no-op",
			],
			"after":            "my-waf-web-acl",
			"after_sensitive":  false,
			"after_unknown":    false,
			"before":           "my-waf-web-acl",
			"before_sensitive": false,
		},
	},
	"planned_values": {
		"outputs": {
			"alb_arn": {
				"sensitive": false,
			},
			"alb_name": {
				"sensitive": false,
				"value":     "my-alb",
			},
			"waf_arn": {
				"sensitive": false,
				"value":     "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
			},
			"waf_id": {
				"sensitive": false,
				"value":     "8690cef0-7421-4b05-9663-c2e226d348f9",
			},
			"waf_name": {
				"sensitive": false,
				"value":     "my-waf-web-acl",
			},
		},
		"root_module": {
			"resources": [
				{
					"address":        "aws_lb.main",
					"mode":           "managed",
					"name":           "main",
					"provider_name":  "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"sensitive_values": {
						"access_logs":     [],
						"security_groups": [],
						"subnet_mapping":  [],
						"subnets": [
							false,
							false,
							false,
						],
						"tags":     {},
						"tags_all": {},
					},
					"type": "aws_lb",
					"values": {
						"access_logs":                      [],
						"customer_owned_ipv4_pool":         null,
						"desync_mitigation_mode":           "defensive",
						"drop_invalid_header_fields":       false,
						"enable_cross_zone_load_balancing": null,
						"enable_deletion_protection":       false,
						"enable_http2":                     true,
						"enable_waf_fail_open":             false,
						"idle_timeout":                     60,
						"internal":                         false,
						"load_balancer_type":               "application",
						"name":                             "my-alb",
						"name_prefix":                      null,
						"preserve_host_header":             false,
						"subnets": [
							"subnet-066c2d3d16fe257e7",
							"subnet-074e6f80a28902317",
							"subnet-0d6f9bc18688e55fd",
						],
						"tags": {
							"Name": "my-alb",
						},
						"tags_all": {
							"Name": "my-alb",
						},
						"timeouts": null,
					},
				},
				{
					"address":        "aws_lb_listener.http",
					"mode":           "managed",
					"name":           "http",
					"provider_name":  "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"sensitive_values": {
						"default_action": [
							{
								"authenticate_cognito": [],
								"authenticate_oidc":    [],
								"fixed_response":       [],
								"forward":              [],
								"redirect":             [],
							},
						],
						"tags_all": {},
					},
					"type": "aws_lb_listener",
					"values": {
						"alpn_policy":     null,
						"certificate_arn": null,
						"default_action": [
							{
								"authenticate_cognito": [],
								"authenticate_oidc":    [],
								"fixed_response":       [],
								"forward":              [],
								"redirect":             [],
								"type":                 "forward",
							},
						],
						"port":     80,
						"protocol": "HTTP",
						"tags":     null,
						"timeouts": null,
					},
				},
				{
					"address":        "aws_lb_target_group.main",
					"mode":           "managed",
					"name":           "main",
					"provider_name":  "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"sensitive_values": {
						"health_check": [
							{},
						],
						"stickiness": [],
						"tags_all":   {},
					},
					"type": "aws_lb_target_group",
					"values": {
						"connection_termination": false,
						"deregistration_delay":   "300",
						"health_check": [
							{
								"enabled":             true,
								"healthy_threshold":   2,
								"interval":            30,
								"matcher":             "200-299",
								"path":                "/",
								"port":                "traffic-port",
								"protocol":            "HTTP",
								"timeout":             5,
								"unhealthy_threshold": 2,
							},
						],
						"lambda_multi_value_headers_enabled": false,
						"name":              "my-target-group",
						"name_prefix":       null,
						"port":              80,
						"protocol":          "HTTP",
						"proxy_protocol_v2": false,
						"slow_start":        0,
						"tags":              null,
						"target_type":       "instance",
						"vpc_id":            "vpc-0635ff1b62125588b",
					},
				},
				{
					"address":        "aws_security_group.alb",
					"mode":           "managed",
					"name":           "alb",
					"provider_name":  "registry.terraform.io/hashicorp/aws",
					"schema_version": 1,
					"sensitive_values": {
						"egress": [
							{
								"cidr_blocks": [
									false,
								],
								"ipv6_cidr_blocks": [],
								"prefix_list_ids":  [],
								"security_groups":  [],
							},
						],
						"ingress": [
							{
								"cidr_blocks": [
									false,
								],
								"ipv6_cidr_blocks": [],
								"prefix_list_ids":  [],
								"security_groups":  [],
							},
							{
								"cidr_blocks": [
									false,
								],
								"ipv6_cidr_blocks": [],
								"prefix_list_ids":  [],
								"security_groups":  [],
							},
						],
						"tags_all": {},
					},
					"type": "aws_security_group",
					"values": {
						"description": "Security group for ALB",
						"egress": [
							{
								"cidr_blocks": [
									"0.0.0.0/0",
								],
								"description":      "",
								"from_port":        0,
								"ipv6_cidr_blocks": [],
								"prefix_list_ids":  [],
								"protocol":         "-1",
								"security_groups":  [],
								"self":             false,
								"to_port":          0,
							},
						],
						"ingress": [
							{
								"cidr_blocks": [
									"0.0.0.0/0",
								],
								"description":      "",
								"from_port":        443,
								"ipv6_cidr_blocks": [],
								"prefix_list_ids":  [],
								"protocol":         "tcp",
								"security_groups":  [],
								"self":             false,
								"to_port":          443,
							},
							{
								"cidr_blocks": [
									"0.0.0.0/0",
								],
								"description":      "",
								"from_port":        80,
								"ipv6_cidr_blocks": [],
								"prefix_list_ids":  [],
								"protocol":         "tcp",
								"security_groups":  [],
								"self":             false,
								"to_port":          80,
							},
						],
						"name": "alb-sg",
						"revoke_rules_on_delete": false,
						"tags":     null,
						"timeouts": null,
					},
				},
				{
					"address":        "aws_wafv2_web_acl.main",
					"mode":           "managed",
					"name":           "main",
					"provider_name":  "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"sensitive_values": {
						"custom_response_body": [],
						"default_action": [
							{
								"allow": [
									{
										"custom_request_handling": [],
									},
								],
								"block": [],
							},
						],
						"rule": [
							{
								"action": [
									{
										"allow": [],
										"block": [
											{
												"custom_response": [],
											},
										],
										"captcha": [],
										"count":   [],
									},
								],
								"override_action": [],
								"rule_label":      [],
								"statement": [
									{
										"and_statement":                [],
										"byte_match_statement":         [],
										"geo_match_statement":          [],
										"ip_set_reference_statement":   [],
										"label_match_statement":        [],
										"managed_rule_group_statement": [],
										"not_statement":                [],
										"or_statement":                 [],
										"rate_based_statement": [
											{
												"forwarded_ip_config":  [],
												"scope_down_statement": [],
											},
										],
										"regex_pattern_set_reference_statement": [],
										"rule_group_reference_statement":        [],
										"size_constraint_statement":             [],
										"sqli_match_statement":                  [],
										"xss_match_statement":                   [],
									},
								],
								"visibility_config": [
									{},
								],
							},
							{
								"action": [],
								"override_action": [
									{
										"count": [],
										"none": [
											{},
										],
									},
								],
								"rule_label": [],
								"statement": [
									{
										"and_statement":              [],
										"byte_match_statement":       [],
										"geo_match_statement":        [],
										"ip_set_reference_statement": [],
										"label_match_statement":      [],
										"managed_rule_group_statement": [
											{
												"excluded_rule":        [],
												"scope_down_statement": [],
											},
										],
										"not_statement":                         [],
										"or_statement":                          [],
										"rate_based_statement":                  [],
										"regex_pattern_set_reference_statement": [],
										"rule_group_reference_statement":        [],
										"size_constraint_statement":             [],
										"sqli_match_statement":                  [],
										"xss_match_statement":                   [],
									},
								],
								"visibility_config": [
									{},
								],
							},
							{
								"action": [],
								"override_action": [
									{
										"count": [],
										"none": [
											{},
										],
									},
								],
								"rule_label": [],
								"statement": [
									{
										"and_statement":              [],
										"byte_match_statement":       [],
										"geo_match_statement":        [],
										"ip_set_reference_statement": [],
										"label_match_statement":      [],
										"managed_rule_group_statement": [
											{
												"excluded_rule":        [],
												"scope_down_statement": [],
											},
										],
										"not_statement":                         [],
										"or_statement":                          [],
										"rate_based_statement":                  [],
										"regex_pattern_set_reference_statement": [],
										"rule_group_reference_statement":        [],
										"size_constraint_statement":             [],
										"sqli_match_statement":                  [],
										"xss_match_statement":                   [],
									},
								],
								"visibility_config": [
									{},
								],
							},
						],
						"tags":     {},
						"tags_all": {},
						"visibility_config": [
							{},
						],
					},
					"type": "aws_wafv2_web_acl",
					"values": {
						"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
						"capacity":             902,
						"custom_response_body": [],
						"default_action": [
							{
								"allow": [
									{
										"custom_request_handling": [],
									},
								],
								"block": [],
							},
						],
						"description": "Web ACL for protection against common web threats",
						"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
						"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
						"name":        "my-waf-web-acl",
						"rule": [
							{
								"action": [
									{
										"allow": [],
										"block": [
											{
												"custom_response": [],
											},
										],
										"captcha": [],
										"count":   [],
									},
								],
								"name":            "RateLimitRule",
								"override_action": [],
								"priority":        3,
								"rule_label":      [],
								"statement": [
									{
										"and_statement":                [],
										"byte_match_statement":         [],
										"geo_match_statement":          [],
										"ip_set_reference_statement":   [],
										"label_match_statement":        [],
										"managed_rule_group_statement": [],
										"not_statement":                [],
										"or_statement":                 [],
										"rate_based_statement": [
											{
												"aggregate_key_type":   "IP",
												"forwarded_ip_config":  [],
												"limit":                1000,
												"scope_down_statement": [],
											},
										],
										"regex_pattern_set_reference_statement": [],
										"rule_group_reference_statement":        [],
										"size_constraint_statement":             [],
										"sqli_match_statement":                  [],
										"xss_match_statement":                   [],
									},
								],
								"visibility_config": [
									{
										"cloudwatch_metrics_enabled": true,
										"metric_name":                "RateLimitRuleMetric",
										"sampled_requests_enabled":   true,
									},
								],
							},
							{
								"action": [],
								"name":   "AWSManagedRulesCommonRuleSet",
								"override_action": [
									{
										"count": [],
										"none": [
											{},
										],
									},
								],
								"priority":   1,
								"rule_label": [],
								"statement": [
									{
										"and_statement":              [],
										"byte_match_statement":       [],
										"geo_match_statement":        [],
										"ip_set_reference_statement": [],
										"label_match_statement":      [],
										"managed_rule_group_statement": [
											{
												"excluded_rule":        [],
												"name":                 "AWSManagedRulesCommonRuleSet",
												"scope_down_statement": [],
												"vendor_name":          "AWS",
												"version":              "",
											},
										],
										"not_statement":                         [],
										"or_statement":                          [],
										"rate_based_statement":                  [],
										"regex_pattern_set_reference_statement": [],
										"rule_group_reference_statement":        [],
										"size_constraint_statement":             [],
										"sqli_match_statement":                  [],
										"xss_match_statement":                   [],
									},
								],
								"visibility_config": [
									{
										"cloudwatch_metrics_enabled": true,
										"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
										"sampled_requests_enabled":   true,
									},
								],
							},
							{
								"action": [],
								"name":   "AWSManagedRulesSQLiRuleSet",
								"override_action": [
									{
										"count": [],
										"none": [
											{},
										],
									},
								],
								"priority":   2,
								"rule_label": [],
								"statement": [
									{
										"and_statement":              [],
										"byte_match_statement":       [],
										"geo_match_statement":        [],
										"ip_set_reference_statement": [],
										"label_match_statement":      [],
										"managed_rule_group_statement": [
											{
												"excluded_rule":        [],
												"name":                 "AWSManagedRulesSQLiRuleSet",
												"scope_down_statement": [],
												"vendor_name":          "AWS",
												"version":              "",
											},
										],
										"not_statement":                         [],
										"or_statement":                          [],
										"rate_based_statement":                  [],
										"regex_pattern_set_reference_statement": [],
										"rule_group_reference_statement":        [],
										"size_constraint_statement":             [],
										"sqli_match_statement":                  [],
										"xss_match_statement":                   [],
									},
								],
								"visibility_config": [
									{
										"cloudwatch_metrics_enabled": true,
										"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
										"sampled_requests_enabled":   true,
									},
								],
							},
						],
						"scope": "REGIONAL",
						"tags": {
							"Name": "my-waf-web-acl",
						},
						"tags_all": {
							"Name": "my-waf-web-acl",
						},
						"visibility_config": [
							{
								"cloudwatch_metrics_enabled": true,
								"metric_name":                "WebACLMetric",
								"sampled_requests_enabled":   true,
							},
						],
					},
				},
				{
					"address":          "aws_wafv2_web_acl_association.main",
					"mode":             "managed",
					"name":             "main",
					"provider_name":    "registry.terraform.io/hashicorp/aws",
					"schema_version":   0,
					"sensitive_values": {},
					"type":             "aws_wafv2_web_acl_association",
					"values": {
						"web_acl_arn": "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
					},
				},
			],
		},
	},
	"prior_state": {
		"format_version":    "1.0",
		"terraform_version": "1.11.4",
		"values": {
			"outputs": {
				"alb_name": {
					"sensitive": false,
					"value":     "my-alb",
				},
				"waf_arn": {
					"sensitive": false,
					"value":     "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
				},
				"waf_id": {
					"sensitive": false,
					"value":     "8690cef0-7421-4b05-9663-c2e226d348f9",
				},
				"waf_name": {
					"sensitive": false,
					"value":     "my-waf-web-acl",
				},
			},
			"root_module": {
				"resources": [
					{
						"address":        "data.aws_subnets.default",
						"mode":           "data",
						"name":           "default",
						"provider_name":  "registry.terraform.io/hashicorp/aws",
						"schema_version": 0,
						"sensitive_values": {
							"filter": [
								{
									"values": [
										false,
									],
								},
								{
									"values": [
										false,
									],
								},
							],
							"ids": [
								false,
								false,
								false,
							],
						},
						"type": "aws_subnets",
						"values": {
							"filter": [
								{
									"name": "default-for-az",
									"values": [
										"true",
									],
								},
								{
									"name": "vpc-id",
									"values": [
										"vpc-0635ff1b62125588b",
									],
								},
							],
							"id": "eu-west-2",
							"ids": [
								"subnet-066c2d3d16fe257e7",
								"subnet-0d6f9bc18688e55fd",
								"subnet-074e6f80a28902317",
							],
							"tags":     null,
							"timeouts": null,
						},
					},
					{
						"address":        "data.aws_vpc.default",
						"mode":           "data",
						"name":           "default",
						"provider_name":  "registry.terraform.io/hashicorp/aws",
						"schema_version": 0,
						"sensitive_values": {
							"cidr_block_associations": [
								{},
							],
							"tags": {},
						},
						"type": "aws_vpc",
						"values": {
							"arn":        "arn:aws:ec2:eu-west-2:941431937708:vpc/vpc-0635ff1b62125588b",
							"cidr_block": "172.31.0.0/16",
							"cidr_block_associations": [
								{
									"association_id": "vpc-cidr-assoc-0b7ae78759daf5b73",
									"cidr_block":     "172.31.0.0/16",
									"state":          "associated",
								},
							],
							"default":              true,
							"dhcp_options_id":      "dopt-0021853fdcf6ded8c",
							"enable_dns_hostnames": true,
							"enable_dns_support":   true,
							"filter":               null,
							"id":                   "vpc-0635ff1b62125588b",
							"instance_tenancy":     "default",
							"ipv6_association_id":  "",
							"ipv6_cidr_block":      "",
							"main_route_table_id":  "rtb-003a5a2184ecabbf1",
							"owner_id":             "941431937708",
							"state":                null,
							"tags":                 {},
							"timeouts":             null,
						},
					},
					{
						"address":        "aws_wafv2_web_acl.main",
						"mode":           "managed",
						"name":           "main",
						"provider_name":  "registry.terraform.io/hashicorp/aws",
						"schema_version": 0,
						"sensitive_values": {
							"custom_response_body": [],
							"default_action": [
								{
									"allow": [
										{
											"custom_request_handling": [],
										},
									],
									"block": [],
								},
							],
							"rule": [
								{
									"action": [
										{
											"allow": [],
											"block": [
												{
													"custom_response": [],
												},
											],
											"captcha": [],
											"count":   [],
										},
									],
									"override_action": [],
									"rule_label":      [],
									"statement": [
										{
											"and_statement":                [],
											"byte_match_statement":         [],
											"geo_match_statement":          [],
											"ip_set_reference_statement":   [],
											"label_match_statement":        [],
											"managed_rule_group_statement": [],
											"not_statement":                [],
											"or_statement":                 [],
											"rate_based_statement": [
												{
													"forwarded_ip_config":  [],
													"scope_down_statement": [],
												},
											],
											"regex_pattern_set_reference_statement": [],
											"rule_group_reference_statement":        [],
											"size_constraint_statement":             [],
											"sqli_match_statement":                  [],
											"xss_match_statement":                   [],
										},
									],
									"visibility_config": [
										{},
									],
								},
								{
									"action": [],
									"override_action": [
										{
											"count": [],
											"none": [
												{},
											],
										},
									],
									"rule_label": [],
									"statement": [
										{
											"and_statement":              [],
											"byte_match_statement":       [],
											"geo_match_statement":        [],
											"ip_set_reference_statement": [],
											"label_match_statement":      [],
											"managed_rule_group_statement": [
												{
													"excluded_rule":        [],
													"scope_down_statement": [],
												},
											],
											"not_statement":                         [],
											"or_statement":                          [],
											"rate_based_statement":                  [],
											"regex_pattern_set_reference_statement": [],
											"rule_group_reference_statement":        [],
											"size_constraint_statement":             [],
											"sqli_match_statement":                  [],
											"xss_match_statement":                   [],
										},
									],
									"visibility_config": [
										{},
									],
								},
								{
									"action": [],
									"override_action": [
										{
											"count": [],
											"none": [
												{},
											],
										},
									],
									"rule_label": [],
									"statement": [
										{
											"and_statement":              [],
											"byte_match_statement":       [],
											"geo_match_statement":        [],
											"ip_set_reference_statement": [],
											"label_match_statement":      [],
											"managed_rule_group_statement": [
												{
													"excluded_rule":        [],
													"scope_down_statement": [],
												},
											],
											"not_statement":                         [],
											"or_statement":                          [],
											"rate_based_statement":                  [],
											"regex_pattern_set_reference_statement": [],
											"rule_group_reference_statement":        [],
											"size_constraint_statement":             [],
											"sqli_match_statement":                  [],
											"xss_match_statement":                   [],
										},
									],
									"visibility_config": [
										{},
									],
								},
							],
							"tags":     {},
							"tags_all": {},
							"visibility_config": [
								{},
							],
						},
						"type": "aws_wafv2_web_acl",
						"values": {
							"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
							"capacity":             902,
							"custom_response_body": [],
							"default_action": [
								{
									"allow": [
										{
											"custom_request_handling": [],
										},
									],
									"block": [],
								},
							],
							"description": "Web ACL for protection against common web threats",
							"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
							"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
							"name":        "my-waf-web-acl",
							"rule": [
								{
									"action": [
										{
											"allow": [],
											"block": [
												{
													"custom_response": [],
												},
											],
											"captcha": [],
											"count":   [],
										},
									],
									"name":            "RateLimitRule",
									"override_action": [],
									"priority":        3,
									"rule_label":      [],
									"statement": [
										{
											"and_statement":                [],
											"byte_match_statement":         [],
											"geo_match_statement":          [],
											"ip_set_reference_statement":   [],
											"label_match_statement":        [],
											"managed_rule_group_statement": [],
											"not_statement":                [],
											"or_statement":                 [],
											"rate_based_statement": [
												{
													"aggregate_key_type":   "IP",
													"forwarded_ip_config":  [],
													"limit":                1000,
													"scope_down_statement": [],
												},
											],
											"regex_pattern_set_reference_statement": [],
											"rule_group_reference_statement":        [],
											"size_constraint_statement":             [],
											"sqli_match_statement":                  [],
											"xss_match_statement":                   [],
										},
									],
									"visibility_config": [
										{
											"cloudwatch_metrics_enabled": true,
											"metric_name":                "RateLimitRuleMetric",
											"sampled_requests_enabled":   true,
										},
									],
								},
								{
									"action": [],
									"name":   "AWSManagedRulesCommonRuleSet",
									"override_action": [
										{
											"count": [],
											"none": [
												{},
											],
										},
									],
									"priority":   1,
									"rule_label": [],
									"statement": [
										{
											"and_statement":              [],
											"byte_match_statement":       [],
											"geo_match_statement":        [],
											"ip_set_reference_statement": [],
											"label_match_statement":      [],
											"managed_rule_group_statement": [
												{
													"excluded_rule":        [],
													"name":                 "AWSManagedRulesCommonRuleSet",
													"scope_down_statement": [],
													"vendor_name":          "AWS",
													"version":              "",
												},
											],
											"not_statement":                         [],
											"or_statement":                          [],
											"rate_based_statement":                  [],
											"regex_pattern_set_reference_statement": [],
											"rule_group_reference_statement":        [],
											"size_constraint_statement":             [],
											"sqli_match_statement":                  [],
											"xss_match_statement":                   [],
										},
									],
									"visibility_config": [
										{
											"cloudwatch_metrics_enabled": true,
											"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
											"sampled_requests_enabled":   true,
										},
									],
								},
								{
									"action": [],
									"name":   "AWSManagedRulesSQLiRuleSet",
									"override_action": [
										{
											"count": [],
											"none": [
												{},
											],
										},
									],
									"priority":   2,
									"rule_label": [],
									"statement": [
										{
											"and_statement":              [],
											"byte_match_statement":       [],
											"geo_match_statement":        [],
											"ip_set_reference_statement": [],
											"label_match_statement":      [],
											"managed_rule_group_statement": [
												{
													"excluded_rule":        [],
													"name":                 "AWSManagedRulesSQLiRuleSet",
													"scope_down_statement": [],
													"vendor_name":          "AWS",
													"version":              "",
												},
											],
											"not_statement":                         [],
											"or_statement":                          [],
											"rate_based_statement":                  [],
											"regex_pattern_set_reference_statement": [],
											"rule_group_reference_statement":        [],
											"size_constraint_statement":             [],
											"sqli_match_statement":                  [],
											"xss_match_statement":                   [],
										},
									],
									"visibility_config": [
										{
											"cloudwatch_metrics_enabled": true,
											"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
											"sampled_requests_enabled":   true,
										},
									],
								},
							],
							"scope": "REGIONAL",
							"tags": {
								"Name": "my-waf-web-acl",
							},
							"tags_all": {
								"Name": "my-waf-web-acl",
							},
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "WebACLMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
					},
				],
			},
		},
	},
	"relevant_attributes": [
		{
			"attribute": [
				"arn",
			],
			"resource": "aws_lb.main",
		},
		{
			"attribute": [
				"arn",
			],
			"resource": "aws_lb_target_group.main",
		},
		{
			"attribute": [
				"id",
			],
			"resource": "data.aws_vpc.default",
		},
		{
			"attribute": [
				"name",
			],
			"resource": "aws_lb.main",
		},
		{
			"attribute": [
				"arn",
			],
			"resource": "aws_wafv2_web_acl.main",
		},
		{
			"attribute": [
				"ids",
			],
			"resource": "data.aws_subnets.default",
		},
		{
			"attribute": [
				"id",
			],
			"resource": "aws_security_group.alb",
		},
	],
	"resource_changes": [
		{
			"address": "aws_lb.main",
			"change": {
				"actions": [
					"create",
				],
				"after": {
					"access_logs":                      [],
					"customer_owned_ipv4_pool":         null,
					"desync_mitigation_mode":           "defensive",
					"drop_invalid_header_fields":       false,
					"enable_cross_zone_load_balancing": null,
					"enable_deletion_protection":       false,
					"enable_http2":                     true,
					"enable_waf_fail_open":             false,
					"idle_timeout":                     60,
					"internal":                         false,
					"load_balancer_type":               "application",
					"name":                             "my-alb",
					"name_prefix":                      null,
					"preserve_host_header":             false,
					"subnets": [
						"subnet-066c2d3d16fe257e7",
						"subnet-074e6f80a28902317",
						"subnet-0d6f9bc18688e55fd",
					],
					"tags": {
						"Name": "my-alb",
					},
					"tags_all": {
						"Name": "my-alb",
					},
					"timeouts": null,
				},
				"after_sensitive": {
					"access_logs":     [],
					"security_groups": [],
					"subnet_mapping":  [],
					"subnets": [
						false,
						false,
						false,
					],
					"tags":     {},
					"tags_all": {},
				},
				"after_unknown": {
					"access_logs":     [],
					"arn":             true,
					"arn_suffix":      true,
					"dns_name":        true,
					"id":              true,
					"ip_address_type": true,
					"security_groups": true,
					"subnet_mapping":  true,
					"subnets": [
						false,
						false,
						false,
					],
					"tags":     {},
					"tags_all": {},
					"vpc_id":   true,
					"zone_id":  true,
				},
				"before":           null,
				"before_sensitive": false,
			},
			"mode":          "managed",
			"name":          "main",
			"provider_name": "registry.terraform.io/hashicorp/aws",
			"type":          "aws_lb",
		},
		{
			"address": "aws_lb_listener.http",
			"change": {
				"actions": [
					"create",
				],
				"after": {
					"alpn_policy":     null,
					"certificate_arn": null,
					"default_action": [
						{
							"authenticate_cognito": [],
							"authenticate_oidc":    [],
							"fixed_response":       [],
							"forward":              [],
							"redirect":             [],
							"type":                 "forward",
						},
					],
					"port":     80,
					"protocol": "HTTP",
					"tags":     null,
					"timeouts": null,
				},
				"after_sensitive": {
					"default_action": [
						{
							"authenticate_cognito": [],
							"authenticate_oidc":    [],
							"fixed_response":       [],
							"forward":              [],
							"redirect":             [],
						},
					],
					"tags_all": {},
				},
				"after_unknown": {
					"arn": true,
					"default_action": [
						{
							"authenticate_cognito": [],
							"authenticate_oidc":    [],
							"fixed_response":       [],
							"forward":              [],
							"order":                true,
							"redirect":             [],
							"target_group_arn":     true,
						},
					],
					"id":                true,
					"load_balancer_arn": true,
					"ssl_policy":        true,
					"tags_all":          true,
				},
				"before":           null,
				"before_sensitive": false,
			},
			"mode":          "managed",
			"name":          "http",
			"provider_name": "registry.terraform.io/hashicorp/aws",
			"type":          "aws_lb_listener",
		},
		{
			"address": "aws_lb_target_group.main",
			"change": {
				"actions": [
					"create",
				],
				"after": {
					"connection_termination": false,
					"deregistration_delay":   "300",
					"health_check": [
						{
							"enabled":             true,
							"healthy_threshold":   2,
							"interval":            30,
							"matcher":             "200-299",
							"path":                "/",
							"port":                "traffic-port",
							"protocol":            "HTTP",
							"timeout":             5,
							"unhealthy_threshold": 2,
						},
					],
					"lambda_multi_value_headers_enabled": false,
					"name":              "my-target-group",
					"name_prefix":       null,
					"port":              80,
					"protocol":          "HTTP",
					"proxy_protocol_v2": false,
					"slow_start":        0,
					"tags":              null,
					"target_type":       "instance",
					"vpc_id":            "vpc-0635ff1b62125588b",
				},
				"after_sensitive": {
					"health_check": [
						{},
					],
					"stickiness": [],
					"tags_all":   {},
				},
				"after_unknown": {
					"arn":        true,
					"arn_suffix": true,
					"health_check": [
						{},
					],
					"id":                            true,
					"ip_address_type":               true,
					"load_balancing_algorithm_type": true,
					"preserve_client_ip":            true,
					"protocol_version":              true,
					"stickiness":                    true,
					"tags_all":                      true,
				},
				"before":           null,
				"before_sensitive": false,
			},
			"mode":          "managed",
			"name":          "main",
			"provider_name": "registry.terraform.io/hashicorp/aws",
			"type":          "aws_lb_target_group",
		},
		{
			"address": "aws_security_group.alb",
			"change": {
				"actions": [
					"create",
				],
				"after": {
					"description": "Security group for ALB",
					"egress": [
						{
							"cidr_blocks": [
								"0.0.0.0/0",
							],
							"description":      "",
							"from_port":        0,
							"ipv6_cidr_blocks": [],
							"prefix_list_ids":  [],
							"protocol":         "-1",
							"security_groups":  [],
							"self":             false,
							"to_port":          0,
						},
					],
					"ingress": [
						{
							"cidr_blocks": [
								"0.0.0.0/0",
							],
							"description":      "",
							"from_port":        443,
							"ipv6_cidr_blocks": [],
							"prefix_list_ids":  [],
							"protocol":         "tcp",
							"security_groups":  [],
							"self":             false,
							"to_port":          443,
						},
						{
							"cidr_blocks": [
								"0.0.0.0/0",
							],
							"description":      "",
							"from_port":        80,
							"ipv6_cidr_blocks": [],
							"prefix_list_ids":  [],
							"protocol":         "tcp",
							"security_groups":  [],
							"self":             false,
							"to_port":          80,
						},
					],
					"name": "alb-sg",
					"revoke_rules_on_delete": false,
					"tags":     null,
					"timeouts": null,
				},
				"after_sensitive": {
					"egress": [
						{
							"cidr_blocks": [
								false,
							],
							"ipv6_cidr_blocks": [],
							"prefix_list_ids":  [],
							"security_groups":  [],
						},
					],
					"ingress": [
						{
							"cidr_blocks": [
								false,
							],
							"ipv6_cidr_blocks": [],
							"prefix_list_ids":  [],
							"security_groups":  [],
						},
						{
							"cidr_blocks": [
								false,
							],
							"ipv6_cidr_blocks": [],
							"prefix_list_ids":  [],
							"security_groups":  [],
						},
					],
					"tags_all": {},
				},
				"after_unknown": {
					"arn": true,
					"egress": [
						{
							"cidr_blocks": [
								false,
							],
							"ipv6_cidr_blocks": [],
							"prefix_list_ids":  [],
							"security_groups":  [],
						},
					],
					"id": true,
					"ingress": [
						{
							"cidr_blocks": [
								false,
							],
							"ipv6_cidr_blocks": [],
							"prefix_list_ids":  [],
							"security_groups":  [],
						},
						{
							"cidr_blocks": [
								false,
							],
							"ipv6_cidr_blocks": [],
							"prefix_list_ids":  [],
							"security_groups":  [],
						},
					],
					"name_prefix": true,
					"owner_id":    true,
					"tags_all":    true,
					"vpc_id":      true,
				},
				"before":           null,
				"before_sensitive": false,
			},
			"mode":          "managed",
			"name":          "alb",
			"provider_name": "registry.terraform.io/hashicorp/aws",
			"type":          "aws_security_group",
		},
		{
			"address": "aws_wafv2_web_acl.main",
			"change": {
				"actions": [
					"no-op",
				],
				"after": {
					"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
					"capacity":             902,
					"custom_response_body": [],
					"default_action": [
						{
							"allow": [
								{
									"custom_request_handling": [],
								},
							],
							"block": [],
						},
					],
					"description": "Web ACL for protection against common web threats",
					"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
					"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
					"name":        "my-waf-web-acl",
					"rule": [
						{
							"action": [
								{
									"allow": [],
									"block": [
										{
											"custom_response": [],
										},
									],
									"captcha": [],
									"count":   [],
								},
							],
							"name":            "RateLimitRule",
							"override_action": [],
							"priority":        3,
							"rule_label":      [],
							"statement": [
								{
									"and_statement":                [],
									"byte_match_statement":         [],
									"geo_match_statement":          [],
									"ip_set_reference_statement":   [],
									"label_match_statement":        [],
									"managed_rule_group_statement": [],
									"not_statement":                [],
									"or_statement":                 [],
									"rate_based_statement": [
										{
											"aggregate_key_type":   "IP",
											"forwarded_ip_config":  [],
											"limit":                1000,
											"scope_down_statement": [],
										},
									],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "RateLimitRuleMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
						{
							"action": [],
							"name":   "AWSManagedRulesCommonRuleSet",
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"priority":   1,
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"name":                 "AWSManagedRulesCommonRuleSet",
											"scope_down_statement": [],
											"vendor_name":          "AWS",
											"version":              "",
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
						{
							"action": [],
							"name":   "AWSManagedRulesSQLiRuleSet",
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"priority":   2,
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"name":                 "AWSManagedRulesSQLiRuleSet",
											"scope_down_statement": [],
											"vendor_name":          "AWS",
											"version":              "",
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
					],
					"scope": "REGIONAL",
					"tags": {
						"Name": "my-waf-web-acl",
					},
					"tags_all": {
						"Name": "my-waf-web-acl",
					},
					"visibility_config": [
						{
							"cloudwatch_metrics_enabled": true,
							"metric_name":                "WebACLMetric",
							"sampled_requests_enabled":   true,
						},
					],
				},
				"after_sensitive": {
					"custom_response_body": [],
					"default_action": [
						{
							"allow": [
								{
									"custom_request_handling": [],
								},
							],
							"block": [],
						},
					],
					"rule": [
						{
							"action": [
								{
									"allow": [],
									"block": [
										{
											"custom_response": [],
										},
									],
									"captcha": [],
									"count":   [],
								},
							],
							"override_action": [],
							"rule_label":      [],
							"statement": [
								{
									"and_statement":                [],
									"byte_match_statement":         [],
									"geo_match_statement":          [],
									"ip_set_reference_statement":   [],
									"label_match_statement":        [],
									"managed_rule_group_statement": [],
									"not_statement":                [],
									"or_statement":                 [],
									"rate_based_statement": [
										{
											"forwarded_ip_config":  [],
											"scope_down_statement": [],
										},
									],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
						{
							"action": [],
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"scope_down_statement": [],
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
						{
							"action": [],
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"scope_down_statement": [],
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
					],
					"tags":     {},
					"tags_all": {},
					"visibility_config": [
						{},
					],
				},
				"after_unknown": {},
				"before": {
					"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
					"capacity":             902,
					"custom_response_body": [],
					"default_action": [
						{
							"allow": [
								{
									"custom_request_handling": [],
								},
							],
							"block": [],
						},
					],
					"description": "Web ACL for protection against common web threats",
					"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
					"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
					"name":        "my-waf-web-acl",
					"rule": [
						{
							"action": [
								{
									"allow": [],
									"block": [
										{
											"custom_response": [],
										},
									],
									"captcha": [],
									"count":   [],
								},
							],
							"name":            "RateLimitRule",
							"override_action": [],
							"priority":        3,
							"rule_label":      [],
							"statement": [
								{
									"and_statement":                [],
									"byte_match_statement":         [],
									"geo_match_statement":          [],
									"ip_set_reference_statement":   [],
									"label_match_statement":        [],
									"managed_rule_group_statement": [],
									"not_statement":                [],
									"or_statement":                 [],
									"rate_based_statement": [
										{
											"aggregate_key_type":   "IP",
											"forwarded_ip_config":  [],
											"limit":                1000,
											"scope_down_statement": [],
										},
									],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "RateLimitRuleMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
						{
							"action": [],
							"name":   "AWSManagedRulesCommonRuleSet",
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"priority":   1,
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"name":                 "AWSManagedRulesCommonRuleSet",
											"scope_down_statement": [],
											"vendor_name":          "AWS",
											"version":              "",
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
						{
							"action": [],
							"name":   "AWSManagedRulesSQLiRuleSet",
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"priority":   2,
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"name":                 "AWSManagedRulesSQLiRuleSet",
											"scope_down_statement": [],
											"vendor_name":          "AWS",
											"version":              "",
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
					],
					"scope": "REGIONAL",
					"tags": {
						"Name": "my-waf-web-acl",
					},
					"tags_all": {
						"Name": "my-waf-web-acl",
					},
					"visibility_config": [
						{
							"cloudwatch_metrics_enabled": true,
							"metric_name":                "WebACLMetric",
							"sampled_requests_enabled":   true,
						},
					],
				},
				"before_sensitive": {
					"custom_response_body": [],
					"default_action": [
						{
							"allow": [
								{
									"custom_request_handling": [],
								},
							],
							"block": [],
						},
					],
					"rule": [
						{
							"action": [
								{
									"allow": [],
									"block": [
										{
											"custom_response": [],
										},
									],
									"captcha": [],
									"count":   [],
								},
							],
							"override_action": [],
							"rule_label":      [],
							"statement": [
								{
									"and_statement":                [],
									"byte_match_statement":         [],
									"geo_match_statement":          [],
									"ip_set_reference_statement":   [],
									"label_match_statement":        [],
									"managed_rule_group_statement": [],
									"not_statement":                [],
									"or_statement":                 [],
									"rate_based_statement": [
										{
											"forwarded_ip_config":  [],
											"scope_down_statement": [],
										},
									],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
						{
							"action": [],
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"scope_down_statement": [],
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
						{
							"action": [],
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"scope_down_statement": [],
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
					],
					"tags":     {},
					"tags_all": {},
					"visibility_config": [
						{},
					],
				},
			},
			"mode":          "managed",
			"name":          "main",
			"provider_name": "registry.terraform.io/hashicorp/aws",
			"type":          "aws_wafv2_web_acl",
		},
		{
			"address": "aws_wafv2_web_acl_association.main",
			"change": {
				"actions": [
					"create",
				],
				"after": {
					"web_acl_arn": "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
				},
				"after_sensitive": {},
				"after_unknown": {
					"id":           true,
					"resource_arn": true,
				},
				"before":           null,
				"before_sensitive": false,
			},
			"mode":          "managed",
			"name":          "main",
			"provider_name": "registry.terraform.io/hashicorp/aws",
			"type":          "aws_wafv2_web_acl_association",
		},
	],
	"resource_drift": [
		{
			"address": "aws_wafv2_web_acl.main",
			"change": {
				"actions": [
					"update",
				],
				"after": {
					"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
					"capacity":             902,
					"custom_response_body": [],
					"default_action": [
						{
							"allow": [
								{
									"custom_request_handling": [],
								},
							],
							"block": [],
						},
					],
					"description": "Web ACL for protection against common web threats",
					"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
					"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
					"name":        "my-waf-web-acl",
					"rule": [
						{
							"action": [
								{
									"allow": [],
									"block": [
										{
											"custom_response": [],
										},
									],
									"captcha": [],
									"count":   [],
								},
							],
							"name":            "RateLimitRule",
							"override_action": [],
							"priority":        3,
							"rule_label":      [],
							"statement": [
								{
									"and_statement":                [],
									"byte_match_statement":         [],
									"geo_match_statement":          [],
									"ip_set_reference_statement":   [],
									"label_match_statement":        [],
									"managed_rule_group_statement": [],
									"not_statement":                [],
									"or_statement":                 [],
									"rate_based_statement": [
										{
											"aggregate_key_type":   "IP",
											"forwarded_ip_config":  [],
											"limit":                1000,
											"scope_down_statement": [],
										},
									],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "RateLimitRuleMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
						{
							"action": [],
							"name":   "AWSManagedRulesCommonRuleSet",
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"priority":   1,
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"name":                 "AWSManagedRulesCommonRuleSet",
											"scope_down_statement": [],
											"vendor_name":          "AWS",
											"version":              "",
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
						{
							"action": [],
							"name":   "AWSManagedRulesSQLiRuleSet",
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"priority":   2,
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"name":                 "AWSManagedRulesSQLiRuleSet",
											"scope_down_statement": [],
											"vendor_name":          "AWS",
											"version":              "",
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
					],
					"scope": "REGIONAL",
					"tags": {
						"Name": "my-waf-web-acl",
					},
					"tags_all": {
						"Name": "my-waf-web-acl",
					},
					"visibility_config": [
						{
							"cloudwatch_metrics_enabled": true,
							"metric_name":                "WebACLMetric",
							"sampled_requests_enabled":   true,
						},
					],
				},
				"after_sensitive": {
					"custom_response_body": [],
					"default_action": [
						{
							"allow": [
								{
									"custom_request_handling": [],
								},
							],
							"block": [],
						},
					],
					"rule": [
						{
							"action": [
								{
									"allow": [],
									"block": [
										{
											"custom_response": [],
										},
									],
									"captcha": [],
									"count":   [],
								},
							],
							"override_action": [],
							"rule_label":      [],
							"statement": [
								{
									"and_statement":                [],
									"byte_match_statement":         [],
									"geo_match_statement":          [],
									"ip_set_reference_statement":   [],
									"label_match_statement":        [],
									"managed_rule_group_statement": [],
									"not_statement":                [],
									"or_statement":                 [],
									"rate_based_statement": [
										{
											"forwarded_ip_config":  [],
											"scope_down_statement": [],
										},
									],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
						{
							"action": [],
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"scope_down_statement": [],
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
						{
							"action": [],
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"scope_down_statement": [],
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
					],
					"tags":     {},
					"tags_all": {},
					"visibility_config": [
						{},
					],
				},
				"after_unknown": {},
				"before": {
					"arn":                  "arn:aws:wafv2:eu-west-2:941431937708:regional/webacl/my-waf-web-acl/8690cef0-7421-4b05-9663-c2e226d348f9",
					"capacity":             902,
					"custom_response_body": [],
					"default_action": [
						{
							"allow": [
								{
									"custom_request_handling": [],
								},
							],
							"block": [],
						},
					],
					"description": "Web ACL for protection against common web threats",
					"id":          "8690cef0-7421-4b05-9663-c2e226d348f9",
					"lock_token":  "18ea49ba-3a85-433c-ab59-bf2d89df5115",
					"name":        "my-waf-web-acl",
					"rule": [
						{
							"action": [
								{
									"allow": [],
									"block": [
										{
											"custom_response": [],
										},
									],
									"captcha": [],
									"count":   [],
								},
							],
							"name":            "RateLimitRule",
							"override_action": [],
							"priority":        3,
							"rule_label":      [],
							"statement": [
								{
									"and_statement":                [],
									"byte_match_statement":         [],
									"geo_match_statement":          [],
									"ip_set_reference_statement":   [],
									"label_match_statement":        [],
									"managed_rule_group_statement": [],
									"not_statement":                [],
									"or_statement":                 [],
									"rate_based_statement": [
										{
											"aggregate_key_type":   "IP",
											"forwarded_ip_config":  [],
											"limit":                1000,
											"scope_down_statement": [],
										},
									],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "RateLimitRuleMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
						{
							"action": [],
							"name":   "AWSManagedRulesCommonRuleSet",
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"priority":   1,
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"name":                 "AWSManagedRulesCommonRuleSet",
											"scope_down_statement": [],
											"vendor_name":          "AWS",
											"version":              null,
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "AWSManagedRulesCommonRuleSetMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
						{
							"action": [],
							"name":   "AWSManagedRulesSQLiRuleSet",
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"priority":   2,
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"name":                 "AWSManagedRulesSQLiRuleSet",
											"scope_down_statement": [],
											"vendor_name":          "AWS",
											"version":              null,
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{
									"cloudwatch_metrics_enabled": true,
									"metric_name":                "AWSManagedRulesSQLiRuleSetMetric",
									"sampled_requests_enabled":   true,
								},
							],
						},
					],
					"scope": "REGIONAL",
					"tags": {
						"Name": "my-waf-web-acl",
					},
					"tags_all": null,
					"visibility_config": [
						{
							"cloudwatch_metrics_enabled": true,
							"metric_name":                "WebACLMetric",
							"sampled_requests_enabled":   true,
						},
					],
				},
				"before_sensitive": {
					"custom_response_body": [],
					"default_action": [
						{
							"allow": [
								{
									"custom_request_handling": [],
								},
							],
							"block": [],
						},
					],
					"rule": [
						{
							"action": [
								{
									"allow": [],
									"block": [
										{
											"custom_response": [],
										},
									],
									"captcha": [],
									"count":   [],
								},
							],
							"override_action": [],
							"rule_label":      [],
							"statement": [
								{
									"and_statement":                [],
									"byte_match_statement":         [],
									"geo_match_statement":          [],
									"ip_set_reference_statement":   [],
									"label_match_statement":        [],
									"managed_rule_group_statement": [],
									"not_statement":                [],
									"or_statement":                 [],
									"rate_based_statement": [
										{
											"forwarded_ip_config":  [],
											"scope_down_statement": [],
										},
									],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
						{
							"action": [],
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"scope_down_statement": [],
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
						{
							"action": [],
							"override_action": [
								{
									"count": [],
									"none": [
										{},
									],
								},
							],
							"rule_label": [],
							"statement": [
								{
									"and_statement":              [],
									"byte_match_statement":       [],
									"geo_match_statement":        [],
									"ip_set_reference_statement": [],
									"label_match_statement":      [],
									"managed_rule_group_statement": [
										{
											"excluded_rule":        [],
											"scope_down_statement": [],
										},
									],
									"not_statement":                         [],
									"or_statement":                          [],
									"rate_based_statement":                  [],
									"regex_pattern_set_reference_statement": [],
									"rule_group_reference_statement":        [],
									"size_constraint_statement":             [],
									"sqli_match_statement":                  [],
									"xss_match_statement":                   [],
								},
							],
							"visibility_config": [
								{},
							],
						},
					],
					"tags": {},
					"visibility_config": [
						{},
					],
				},
			},
			"mode":          "managed",
			"name":          "main",
			"provider_name": "registry.terraform.io/hashicorp/aws",
			"type":          "aws_wafv2_web_acl",
		},
	],
	"terraform_version": "1.11.4",
	"timestamp":         "2025-05-09T12:47:51Z",
	"variables": {
		"waf_name": {
			"value": "my-waf-web-acl",
		},
	},
}
